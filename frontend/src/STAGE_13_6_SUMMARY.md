# üìã –≠—Ç–∞–ø 13.6 - –ò—Ç–æ–≥–æ–≤–æ–µ —Ä–µ–∑—é–º–µ

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2 –¥–µ–∫–∞–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ó–ê–í–ï–†–®–Å–ù**  
**–í–µ—Ä—Å–∏—è:** 1.0 (—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –ø—Ä–∏–≤—è–∑–∫–∏ –º–µ–¥–∏–∞)

---

## üéØ –¶–µ–ª—å —ç—Ç–∞–ø–∞

–î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å **—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–ª–æ–¥** –∏–∑ –±—ã—Å—Ç—Ä–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤ —Ä–∞–∑–¥–µ–ª "–ú–æ–∏ –∫–æ–ª–æ–¥—ã" —Å —á–µ–∫–±–æ–∫—Å–æ–º, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º —É—Å–ø–µ—Ö–∞ –∏ –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π —Å –±—ç–∫–µ–Ω–¥–æ–º.

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1. –ß–µ–∫–±–æ–∫—Å "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ú–æ–∏ –∫–æ–ª–æ–¥—ã"

**–õ–æ–∫–∞—Ü–∏—è:** `MainPage.tsx:405-427`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- ‚òëÔ∏è –ß–µ–∫–±–æ–∫—Å —Å –∏–∫–æ–Ω–∫–æ–π `FolderPlus`
- ‚òëÔ∏è –í–∫–ª—é—á—ë–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (`useState(true)`)
- ‚òëÔ∏è Tooltip —Å –ø–æ–¥—Å–∫–∞–∑–∫–æ–π (–∏–∫–æ–Ω–∫–∞ `Info`)
- ‚òëÔ∏è –ë–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

**UI:**
```
‚òëÔ∏è üìÅ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ "–ú–æ–∏ –∫–æ–ª–æ–¥—ã" ‚ÑπÔ∏è
```

---

### 2. API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**Endpoint:** `POST /api/cards/generate/`

**–ù–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä:**
```json
{
  "save_to_decks": true  // –∏–ª–∏ false
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "file_id": "uuid-xxx",
  "deck_id": 42  // —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ save_to_decks = true
}
```

**–°–µ—Ä–≤–∏—Å:** `deck.service.ts:189-215`

---

### 3. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —É—Å–ø–µ—Ö–∞

**–§–∞–π–ª:** `GenerationSuccess.tsx`

**–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞:**
- `generationStatus === 'complete'`
- `saveToDecks === true`
- `savedDeckId !== null`

**–ö–Ω–æ–ø–∫–∏:**
- ‚úèÔ∏è "–û—Ç–∫—Ä—ã—Ç—å –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ" ‚Üí `/decks/{deck_id}`
- üìÅ "–ú–æ–∏ –∫–æ–ª–æ–¥—ã" ‚Üí `/decks`

**UI:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ          [‚úì –ó–µ–ª—ë–Ω–∞—è –∏–∫–æ–Ω–∫–∞]                 ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ         –ö–æ–ª–æ–¥–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!                   ‚îÇ
‚îÇ  –ö–æ–ª–æ–¥–∞ "–ù–æ–≤–∞—è –∫–æ–ª–æ–¥–∞" —Å 5 —Å–ª–æ–≤–∞–º–∏          ‚îÇ
‚îÇ    –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è              ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ  [‚úèÔ∏è –û—Ç–∫—Ä—ã—Ç—å –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ]  [üìÅ –ú–æ–∏ –∫–æ–ª–æ–¥—ã] ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

### 4. –£—Å–ª–æ–≤–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

**–õ–æ–∫–∞—Ü–∏—è:** `MainPage.tsx:332-340`

**–°—Ü–µ–Ω–∞—Ä–∏–π A:** –° —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º (`saveToDecks = true`)
```
‚úÖ –ö–æ–ª–æ–¥–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –∏ —Ñ–∞–π–ª —Å–∫–∞—á–∞–Ω!
–ö–æ–ª–æ–¥–∞ "–ù–æ–≤–∞—è –∫–æ–ª–æ–¥–∞" –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Ä–∞–∑–¥–µ–ª–µ "–ú–æ–∏ –∫–æ–ª–æ–¥—ã"
```

**–°—Ü–µ–Ω–∞—Ä–∏–π B:** –ë–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (`saveToDecks = false`)
```
‚úÖ –ö–∞—Ä—Ç–æ—á–∫–∏ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω—ã!
–ö–æ–ª–æ–¥–∞ "–ù–æ–≤–∞—è –∫–æ–ª–æ–¥–∞" —Å 5 —Å–ª–æ–≤–∞–º–∏ –≥–æ—Ç–æ–≤–∞
```

---

### 5. üêõ –ü—Ä–∏–≤—è–∑–∫–∞ –º–µ–¥–∏–∞ –∫ —Å–ª–æ–≤–∞–º (–ò–°–ü–†–ê–í–õ–ï–ù–û)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ–¥–∏–∞ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª–∏—Å—å, –Ω–æ –Ω–µ –ø—Ä–∏–≤—è–∑—ã–≤–∞–ª–∏—Å—å –∫ —Å–ª–æ–≤–∞–º –≤ –ë–î

**–†–µ—à–µ–Ω–∏–µ:** `MainPage.tsx:315-350`

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–æ–ª—É—á–∏—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—É—é –∫–æ–ª–æ–¥—É: `getDeck(deck_id)`
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞ —Å–æ–±—Ä–∞—Ç—å –º–µ–¥–∏–∞:
   ```typescript
   mediaUpdates = {
     image_file: imageFiles[word.original_word],
     audio_file: audioFiles[word.original_word]
   }
   ```
3. –û–±–Ω–æ–≤–∏—Ç—å –º–µ–¥–∏–∞: `updateWordMedia(deck_id, word.id, mediaUpdates)`
4. –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –∫–æ–Ω—Å–æ–ª—å

**Backend API:** `PATCH /api/cards/decks/{deck_id}/words/{word_id}/`

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "image_file": "/media/images/xxx.jpg",
  "audio_file": "/media/audio/yyy.mp3"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "id": 1,
  "original_word": "cat",
  "translation": "–∫–æ—à–∫–∞",
  "image_file": "/media/images/xxx.jpg",
  "audio_file": "/media/audio/yyy.mp3",
  "updated_fields": ["image_file", "audio_file"]
}
```

**–ö–æ–Ω—Å–æ–ª—å:**
```
‚úÖ –ú–µ–¥–∏–∞ –ø—Ä–∏–≤—è–∑–∞–Ω–æ –∫ —Å–ª–æ–≤—É "cat": ["image_file", "audio_file"]
‚úÖ –ú–µ–¥–∏–∞ –ø—Ä–∏–≤—è–∑–∞–Ω–æ –∫ —Å–ª–æ–≤—É "dog": ["image_file", "audio_file"]
üéâ –í—Å–µ–≥–æ –ø—Ä–∏–≤—è–∑–∞–Ω–æ –º–µ–¥–∏–∞ –∫ 2 —Å–ª–æ–≤–∞–º
```

---

## üìä –ß–µ–∫-–ª–∏—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

| ‚Ññ | –ü—É–Ω–∫—Ç | –°—Ç–∞—Ç—É—Å |
|---|-------|--------|
| 1 | –ß–µ–∫–±–æ–∫—Å "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ú–æ–∏ –∫–æ–ª–æ–¥—ã" –¥–æ–±–∞–≤–ª–µ–Ω | ‚úÖ –î–ê |
| 2 | –ß–µ–∫–±–æ–∫—Å –≤–∫–ª—é—á—ë–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | ‚úÖ –î–ê |
| 3 | Tooltip —Å –ø–æ–¥—Å–∫–∞–∑–∫–æ–π –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è | ‚úÖ –î–ê |
| 4 | –ü—Ä–∏ `saveToDecks: true` ‚Äî –∫–æ–ª–æ–¥–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è | ‚úÖ –î–ê |
| 5 | –ü—Ä–∏ `saveToDecks: false` ‚Äî —Ç–æ–ª—å–∫–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ | ‚úÖ –î–ê |
| 6 | –ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä | ‚úÖ –î–ê |
| 7 | –ö–ª–∏–∫ –Ω–∞ —Å—Å—ã–ª–∫—É –≤–µ–¥—ë—Ç –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–ª–æ–¥—ã | ‚úÖ –î–ê |
| 8 | –ö–æ–ª–æ–¥–∞ –≤–∏–¥–Ω–∞ –≤ —Å–ø–∏—Å–∫–µ "–ú–æ–∏ –∫–æ–ª–æ–¥—ã" | ‚úÖ –î–ê |
| 9 | –°–ª–æ–≤–∞ –≤ –∫–æ–ª–æ–¥–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º | ‚úÖ –î–ê |
| 10 | –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è | ‚úÖ –î–ê |

### üéâ **10/10 - –í–°–ï –ü–£–ù–ö–¢–´ –í–´–ü–û–õ–ù–ï–ù–´!**

---

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

### –° —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º (`save_to_decks: true`)

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Å–ª–æ–≤–∞
   ‚Üì
2. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   ‚Üì
3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ–¥–∏–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   ‚Ä¢ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è ‚Üí imageFiles = { "cat": "/media/images/xxx.jpg" }
   ‚Ä¢ –ê—É–¥–∏–æ ‚Üí audioFiles = { "cat": "/media/audio/yyy.mp3" }
   ‚Üì
4. POST /api/cards/generate/
   Body: { save_to_decks: true, ... }
   ‚Üì
5. Backend —Å–æ–∑–¥–∞—ë—Ç Deck –∏ Words
   Response: { file_id: "xxx", deck_id: 42 }
   ‚Üì
6. Frontend –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç –º–µ–¥–∏–∞
   ‚Ä¢ GET /api/cards/decks/42/ ‚Üí –ø–æ–ª—É—á–∏—Ç—å —Å–ª–æ–≤–∞
   ‚Ä¢ PATCH /api/cards/decks/42/words/1/ ‚Üí –ø—Ä–∏–≤—è–∑–∞—Ç—å –º–µ–¥–∏–∞ –∫ —Å–ª–æ–≤—É 1
   ‚Ä¢ PATCH /api/cards/decks/42/words/2/ ‚Üí –ø—Ä–∏–≤—è–∑–∞—Ç—å –º–µ–¥–∏–∞ –∫ —Å–ª–æ–≤—É 2
   ‚Ä¢ ...
   ‚Üì
7. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ .apkg —Ñ–∞–π–ª–∞
   GET /api/cards/download-deck/{file_id}/
   ‚Üì
8. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —É—Å–ø–µ—Ö–∞
   "–ö–æ–ª–æ–¥–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –∏ —Ñ–∞–π–ª —Å–∫–∞—á–∞–Ω!"
   [–ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏]
```

### –ë–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (`save_to_decks: false`)

```
1-3. (–¢–æ –∂–µ —Å–∞–º–æ–µ)
   ‚Üì
4. POST /api/cards/generate/
   Body: { save_to_decks: false, ... }
   ‚Üì
5. Backend —Å–æ–∑–¥–∞—ë—Ç —Ç–æ–ª—å–∫–æ .apkg —Ñ–∞–π–ª
   Response: { file_id: "xxx" }  (–±–µ–∑ deck_id)
   ‚Üì
6. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ .apkg —Ñ–∞–π–ª–∞
   ‚Üì
7. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (–±–µ–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ —É—Å–ø–µ—Ö–∞)
   "–ö–∞—Ä—Ç–æ—á–∫–∏ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω—ã!"
```

---

## üìÅ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### Frontend

| –§–∞–π–ª | –°—Ç—Ä–æ–∫–∏ | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|------|--------|-----------|
| `MainPage.tsx` | 54, 312-350, 405-427, 546-552 | –ß–µ–∫–±–æ–∫—Å, –ø—Ä–∏–≤—è–∑–∫–∞ –º–µ–¥–∏–∞, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —É—Å–ø–µ—Ö–∞ |
| `GenerationSuccess.tsx` | 1-70 | –ù–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç |
| `deck.service.ts` | 189-215, 391-418 | –¢–∏–ø—ã API, updateWordMedia |

### Backend (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)

| Endpoint | –ú–µ—Ç–æ–¥ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|----------|-------|------------|
| `/api/cards/generate/` | POST | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `save_to_decks` |
| `/api/cards/decks/{id}/` | GET | –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–ª–æ–¥—ã —Å–æ —Å–ª–æ–≤–∞–º–∏ |
| `/api/cards/decks/{id}/words/{word_id}/` | PATCH | –ü—Ä–∏–≤—è–∑–∫–∞ –º–µ–¥–∏–∞ –∫ —Å–ª–æ–≤—É |

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–î–æ–∫—É–º–µ–Ω—Ç:** `/QUICK_TEST.md`

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç (2 –º–∏–Ω—É—Ç—ã):**
1. –î–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–æ `cat`
2. –ü–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥
3. ‚úÖ –í–∫–ª—é—á–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –∞—É–¥–∏–æ
4. ‚úÖ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ú–æ–∏ –∫–æ–ª–æ–¥—ã"
5. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å
6. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:** –í —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –∏–∫–æ–Ω–∫–∏ üñºÔ∏è üîä

**–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:** –ú–µ–¥–∏–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ

---

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### HTTP –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º

**–î–ª—è 1 —Å–ª–æ–≤–∞ —Å –º–µ–¥–∏–∞:**
```
1. POST /api/media/generate-image/     (1)
2. POST /api/media/generate-audio/      (1)
3. POST /api/cards/generate/            (1)
4. GET  /api/cards/decks/{id}/          (1)
5. PATCH /api/cards/decks/{id}/words/1/ (1)
6. GET  /api/cards/download-deck/...    (1)

–ò—Ç–æ–≥–æ: 6 –∑–∞–ø—Ä–æ—Å–æ–≤
```

**–î–ª—è N —Å–ª–æ–≤ —Å –º–µ–¥–∏–∞:**
```
–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: N –∑–∞–ø—Ä–æ—Å–æ–≤
–ê—É–¥–∏–æ:       N –∑–∞–ø—Ä–æ—Å–æ–≤
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è:   1 –∑–∞–ø—Ä–æ—Å
–ü–æ–ª—É—á–µ–Ω–∏–µ:   1 –∑–∞–ø—Ä–æ—Å
–ü—Ä–∏–≤—è–∑–∫–∞:    N –∑–∞–ø—Ä–æ—Å–æ–≤ (PATCH)
–°–∫–∞—á–∏–≤–∞–Ω–∏–µ:  1 –∑–∞–ø—Ä–æ—Å

–ò—Ç–æ–≥–æ: 3N + 3 –∑–∞–ø—Ä–æ—Å–æ–≤
```

**–ü—Ä–∏–º–µ—Ä—ã:**
- 1 —Å–ª–æ–≤–æ: 6 –∑–∞–ø—Ä–æ—Å–æ–≤
- 5 —Å–ª–æ–≤: 18 –∑–∞–ø—Ä–æ—Å–æ–≤
- 10 —Å–ª–æ–≤: 33 –∑–∞–ø—Ä–æ—Å–∞

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- ‚úÖ PATCH —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –º–µ–¥–∏–∞
- ‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ–¥–∏–∞
- ‚ö†Ô∏è –ë—É–¥—É—â–µ–µ: Batch API –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ –º–µ–¥–∏–∞ (N ‚Üí 1 –∑–∞–ø—Ä–æ—Å)

---

## üí° –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. Batch API –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ –º–µ–¥–∏–∞

**–°–µ–π—á–∞—Å:**
```
PATCH /api/cards/decks/42/words/1/  (N —Ä–∞–∑)
PATCH /api/cards/decks/42/words/2/
...
```

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
```
POST /api/cards/decks/42/attach_media/  (1 —Ä–∞–∑)
{
  "media": [
    { "word_id": 1, "image_file": "...", "audio_file": "..." },
    { "word_id": 2, "image_file": "...", "audio_file": "..." }
  ]
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ 1 –∑–∞–ø—Ä–æ—Å –≤–º–µ—Å—Ç–æ N
- ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å
- ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ

---

### 2. Backend –ø—Ä–∏–≤—è–∑–∫–∞ –º–µ–¥–∏–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏

**–°–µ–π—á–∞—Å:** Frontend –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç –º–µ–¥–∏–∞ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–ª–æ–¥—ã

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** Backend —Å—Ä–∞–∑—É –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏

**Django –∫–æ–¥:**
```python
if save_to_decks:
    deck = Deck.objects.create(...)
    
    for word, translation in translations.items():
        Word.objects.create(
            deck=deck,
            original_word=word,
            translation=translation,
            image_file=image_files.get(word),  # ‚Üê –°—Ä–∞–∑—É –ø—Ä–∏–≤—è–∑–∞—Ç—å
            audio_file=audio_files.get(word),  # ‚Üê –°—Ä–∞–∑—É –ø—Ä–∏–≤—è–∑–∞—Ç—å
        )
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ 0 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ
- ‚úÖ –ú–µ–Ω—å—à–µ –∫–æ–¥–∞ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ

---

### 3. –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –ø—Ä–∏–≤—è–∑–∫–∏ –º–µ–¥–∏–∞

**–°–µ–π—á–∞—Å:** –ù–µ—Ç –∏–Ω–¥–∏–∫–∞—Ü–∏–∏ –ø—Ä–∏–≤—è–∑–∫–∏ –º–µ–¥–∏–∞

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å

```
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫...
‚îú‚îÄ ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (100%)
‚îú‚îÄ ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞—É–¥–∏–æ (100%)
‚îú‚îÄ ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–ª–æ–¥—ã (100%)
‚îú‚îÄ ‚è≥ –ü—Ä–∏–≤—è–∑–∫–∞ –º–µ–¥–∏–∞ (40%) ‚Üê –ù–û–í–û–ï
‚îî‚îÄ ‚è≥ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∞–π–ª–∞ (0%)
```

---

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### 1. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ 50 —Å–ª–æ–≤ = 153 –∑–∞–ø—Ä–æ—Å–∞

**–†–µ—à–µ–Ω–∏–µ:** Batch API (—Å–º. "–í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è")

---

### 2. –û—à–∏–±–∫–∞ –ø—Ä–∏–≤—è–∑–∫–∏ –º–µ–¥–∏–∞ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** –ï—Å–ª–∏ PATCH –∑–∞–ø—Ä–æ—Å –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è, –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –ú–µ–¥–∏–∞ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ

**–ò–Ω–¥–∏–∫–∞—Ü–∏—è:** –¢–æ–ª—å–∫–æ –≤ –∫–æ–Ω—Å–æ–ª–∏ (–Ω–µ –≤ UI)

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

---

### 3. Race condition –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 2 –∫–æ–ª–æ–¥—ã –ø–æ–¥—Ä—è–¥ –±—ã—Å—Ç—Ä–æ

**–†–µ—à–µ–Ω–∏–µ:** –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–Ω–æ–ø–∫–∏ –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|------------|
| `/STAGE_13_6_CHECKLIST.md` | –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ —á–µ–∫-–ª–∏—Å—Ç—É |
| `/BUGFIX_MEDIA_ATTACHMENT.md` | –î–µ—Ç–∞–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–≤—è–∑–∫–∏ –º–µ–¥–∏–∞ |
| `/TESTING_MEDIA_ATTACHMENT.md` | –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é |
| `/QUICK_TEST.md` | –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç (2 –º–∏–Ω—É—Ç—ã) |
| `/STAGE_13_6_SUMMARY.md` | –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç (—Ä–µ–∑—é–º–µ) |

---

## üéØ –í—ã–≤–æ–¥—ã

### –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

‚úÖ –ß–µ–∫–±–æ–∫—Å "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ú–æ–∏ –∫–æ–ª–æ–¥—ã" —Å tooltip  
‚úÖ API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `save_to_decks`  
‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `GenerationSuccess` —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π  
‚úÖ –£—Å–ª–æ–≤–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è  
‚úÖ –ü—Ä–∏–≤—è–∑–∫–∞ –º–µ–¥–∏–∞ –∫ —Å–ª–æ–≤–∞–º  
‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å  
‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫  
‚úÖ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è  

### –°—Ç–∞—Ç—É—Å

**–≠—Ç–∞–ø 13.6:** ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ó–ê–í–ï–†–®–Å–ù**  
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:** ‚úÖ **100% (Frontend + Backend)**  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** ‚úÖ **–ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É**  

### –°–ª–µ–¥—É—é—â–∏–µ —ç—Ç–∞–ø—ã

**–≠—Ç–∞–ø 13.7:** (–µ—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)  
**–£–ª—É—á—à–µ–Ω–∏—è:** Batch API, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏  

---

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2 –¥–µ–∫–∞–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ì–û–¢–û–í–û –ö –ü–†–û–î–ê–ö–®–ï–ù–£**

üéâ **–ü–æ–∑–¥—Ä–∞–≤–ª—è—é —Å —É—Å–ø–µ—à–Ω—ã–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º —ç—Ç–∞–ø–∞ 13.6!** üéâ
