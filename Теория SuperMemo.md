
#### **Идея обучения** - *минимизировать число повторений, сохраняя заданную вероятность удержания*

#### Цель - повторять как можно реже, но перед самым забыванием

При этом повторять перед самым забыванием - опасно, так как велик риск "выгорания" пользователя. Поэтому реальные повторения начинаются с вероятности забывания 1- процентов и постепенно увеличиваются. 


# Система интервального повторения: формулы, параметры и адаптация

## Общая концепция и кривые забывания

Интервальное повторение основано на свойстве памяти: **кривая забывания** показывает, как со временем снижается вероятность воспоминания выученного материала. Без повторений память о новой информации убывает _экспоненциально_: сначала очень быстро, затем все медленнее. Это можно описать формулой, например:
$$
R(t)=e^{-\frac{t}{S}}
$$
где R(t) – вероятность вспомнить через время t после изучения, а S – **стабильность памяти** (характерный «временной параметр» для данной информации). Чем больше τ, тем медленнее затухает кривая: например, если S=365 дней, то через год вероятность воспоминания упадет примерно до 37%, а при S=30 дней – до 37% уже за месяц. В литературе часто используют «период полураспада» памяти (время до падения вероятности до 50%), но в системе удобнее целиться на более высокий уровень – скажем, **90%**. Время τ, за которое вероятность падает со 100% до 90%, можно принять за показатель стабильности.

Каждая порция знаний имеет свою кривую забывания (зависит от сложности материала и свойств памяти человека). Однако **повторения способны “сглаживать” эти кривые**: после успешного воспроизведения информация закрепляется лучше, и последующая кривая забывания идет более полого. При регулярных правильных повторениях рост интервала между повторениями происходит **экспоненциально**, что позволяет надолго сохранять знания с минимальным числом повторений.

## Алгоритм расчета интервалов повторения

**Задача алгоритма** – автоматизировать назначение оптимальных интервалов между повторениями, поддерживая высокую вероятность вспоминания (например, ~90%) при минимальном числе повторов. Система будет использовать классический подход, разработанный в SuperMemo, с четырьмя степенями оценки ответа пользователя: **«Снова», «Трудно», «Хорошо», «Легко»**. От выбора этой оценки зависят пересчет интервала и корректировка индивидуальных параметров карточки.

Основные сущности алгоритма:

- **Интервал (интервал повторения)** – количество времени до следующего показа карточки.
    
- **Ease Factor (коэффициент легкости)** – показатель, как быстро удлиняются интервалы для данной карточки (аналог «стабильности» знания). Стартовое значение задается по умолчанию (~2.5, то есть 250%).
    
- **Количество повторений** – номер текущего повторения данной карточки (1-е, 2-е, 3-е и т.д.), влияющий на расчет интервала.
    
- **Оценка ответа** – одна из 4 градаций качества воспоминания, которую выбрал пользователь («Снова» – не вспомнил, «Трудно» – с большим трудом, «Хорошо» – уверенно, «Легко» – без усилий).
    

Алгоритм планирования можно обобщенно описать так:

1. **Начальные интервалы.** Первое повторение нового материала назначается через короткий интервал (обычно 1 день). Второе повторение – через несколько дней (типично ~6 дней). Эти значения выбраны исходя из практики: однодневный интервал закрепляет материал на свежую память, а неделя – первый тест на долговременное запоминание.
    
2. **Дальнейшие интервалы.** После каждого успешного воспоминания интервал увеличивается в несколько раз – примерно **в экспоненциальной прогрессии**. Формула для nn-го интервала (если предыдущий повтор был успешным):

$$
I(n)=I(n-1)\cdot EF
$$


    где EF – текущий Ease Factor карточки. Изначально EF=2.5 (т.е. интервалы растут ~в 2.5 раза при каждом следующем успехе). Например, если карточка повторена на 2-й день, то следующий повтор будет назначен примерно через 2.5×2=5 дней, затем 5×2.5≈12.5 дней, потом ~31 день и т.д. (с учетом корректировок по оценкам ниже).
    
3. **Оценка «Снова» (не вспомнил).** Если пользователь не смог вспомнить слово и нажал «Снова», карточка считается забытой. **Действия:** интервал сбрасывается – карточка переходит в режим краткосрочного повторения внутри текущей сессии (см. ниже), а после этого будет запланирована как если бы это было **первое повторение** (интервал I(1)≈1 день). При этом Ease Factor может быть понижен (чтобы в будущем интервалы росли медленнее для этой трудной карточки). Рекомендуется уменьшать EF на ~0.2 (20 процентных пунктов) при провале. Например, если был EF=2.5 (250%), после повторных забываний он может снизиться до минимального порога (см. “Ограничения” ниже), допустим до 1.3 (130%). Это защитит от слишком длительных интервалов для сложного материала.
    
4. **Оценка «Трудно».** Если слово вспомнено с большим трудом, пользователь отмечает «Трудно». **Действия:** карточка считается усвоенной (не сбрасывается), но следующий интервал увеличивается незначительно. По умолчанию мы можем задать коэффициент для "трудно": например, новый интервал = текущий интервал × **1.2** (т.е. на 20% длиннее). Кроме того, Ease Factor немного снижается (рекомендуется на ~0.15, или 15 процентных пунктов), поскольку эта карточка оказалась сложнее ожидаемого. В итоге материал будет повторен скоро вновь. Пример: текущий интервал был 10 дней, EF=2.5; нажали «Трудно» – следующий интервал = 10×1.2=12 дней, а EF снижается до ~2.35 (235%).
    
5. **Оценка «Хорошо».** Нормальное воспоминание без особых затруднений – выбор «Хорошо». **Действия:** алгоритм воспринимает это как подтверждение адекватности текущего интервала. Следующий интервал рассчитывается стандартно: Inext=Icurrent​×EF. Ease Factor при этом можно оставить без изменения или слегка подкорректировать. В оригинальной формуле SM-2 качество 4 (Good) не меняет EF, либо можно задать незначительное изменение (например, −0.05−0.05 или 0). Мы примем, что EF остается тем же. Пример: текущий интервал 10 дней, EF=2.5; «Хорошо» → следующий интервал = 10×2.5=25 дней (около 3.5 недель), EF остаётся ~2.5.
    
6. **Оценка «Легко».** Если пользователь вспоминает ответ очень легко, нажимается «Легко». **Действия:** система удлиняет интервал более агрессивно, чтобы не тратить время на слишком частые повторения этого простого материала. Обычно делается **бонус к интервалу** и росту EF. Например, можно умножить интервал на EF _дополнительно_ на коэффициент Easy Bonus (скажем, 1.3 или +30%). Также EF повышается (например, +0.15, то есть +15 пунктов). В результате карточка будет повторяться реже в будущем. Пример: предыдущий интервал 10 дней, EF=2.5; «Легко» → EFnew​≈2.65 (265%), а следующий интервал = 10×2.5×1.3≈32.5 дней.
    

**Ограничения и константы:** Практика показывает, что слишком маленькие значения EF неэффективны – карточка застревает в «петле» частых повторов и раздражает пользователя. Поэтому вводится нижний предел, например **EFmin⁡=1.3** (130%). Даже если пользователь много раз нажимает «Снова»/«Трудно», коэффициент легкости не опустится ниже 1.3. Это значит, что даже в худшем случае интервалы всё равно будут чуть увеличиваться (на 30% каждый раз), а не стремиться к нулю. Верхний предел EF обычно не фиксируют – теоретически он может расти (если всегда нажимают «Легко»), но на практике редко превышает ~3.0–3.5 (300–350%). Также можно ограничить **максимальный интервал** – например, не больше N лет, чтобы гарантировать хоть какие-то повторения (по умолчанию часто ставят ~100 лет как технический предел). Ещё одно правило: новый интервал (при ответах «Трудно», «Хорошо», «Легко») **всегда должен быть больше предыдущего** минимум на 1 день, чтобы интервалы монотонно росли и не было бессмысленного уменьшения промежутков при успехах.


**Итоговая таблица действий по оценкам:** (для уже усвоенных карточек)

- **Снова (0):** забыто – сброс к началу. Интервал = 0 (повторение через несколько минут в сессии, затем как I(1)=1I(1)=1 день). EF=EF−0.2EF=EF−0.2 (но не ниже 1.3).
    
- **Трудно (1):** вспомнил с трудом. Интервал = Iprev×1.2Iprev​×1.2. EF=EF−0.15EF=EF−0.15.
    
- **Хорошо (2):** вспомнил нормально. Интервал = Iprev×EFIprev​×EF. EFEF без изменения (небольшое снижение или увеличение по усмотрению, напр. 0).
    
- **Легко (3):** вспомнил очень легко. Интервал = Iprev×EF×1.3Iprev​×EF×1.3. EF=EF+0.15EF=EF+0.15.
    

_(Здесь коэффициенты 1.2 и 1.3 – рекомендуемые, их можно настроить. Приведены значения по умолчанию, используемые, например, в Anki.)_

## Краткосрочное повторение внутри сессии (режим обучения)

Важно различать **режим изучения нового материала** (или повторения забытого) и **режим долгосрочного хранения**. Когда пользователь впервые учит слово или только что ошибся на повторении, карточка переходит в режим интенсивного повторения **в пределах текущей сессии**. Цель – закрепить свежую информацию сразу же, пока сессия продолжается, и довести вероятность воспоминания до ~100% к её концу.

**Как это реализовать:** для новых и забытых карточек задаются короткие интервалы в минутах. Например, после нажатия «Снова» система может показать ту же карточку через ~**2 минуты** (первый шаг внутри сессии). Если пользователь вспомнил слово при повторном показе, карточка откладывается еще на **5–10 минут** и показывается снова. Только после нескольких таких успешных повторов в течение, скажем, ~10–15 минут, карточка считается «выученной» в рамках сессии. Далее она **«выпускается» в долгосрочное планирование** – первый интервал ставится 1 день, как описано выше.

Такой подход схож с методикой «learning steps» в Anki: например, шаги `1m -> 10m -> 1d` означают, что новая карточка сначала повторяется через 1 минуту, потом через 10 минут, и после успешного 10-минутного повторения – только на следующий день. В нашей системе можно рекомендовать, например, два шага: **2 минуты** и **10 минут** (вместо 1 и 10). Пользовательский ответ **«Хорошо»** на новом слове переведет его на следующий шаг (с 2м на 10м, затем на 1 день), а ответ **«Снова»** вернет к первому шагу.

**Кнопка «Трудно» внутри сессии** обычно повторяет тот же шаг (или дает промежуточное значение между 2м и 10м – например ~6 минут). Но зачастую в режиме обучения достаточно «Снова» и «Хорошо»: либо вы не вспомнили и повторяете немедленно, либо вспомнили и двигаетесь к следующему интервалу. Кнопка «Легко» на новом материале может сразу перескакивать шаги. Например, если нажать «Легко» на новом слове, система может сразу считать его усвоенным и назначить повтор через 1 день, минуя второй шаг (т.е. досрочно выпустить карточку в режим долгосрочного хранения).

**Почему это важно:** краткие повторения в течение первой учебной сессии значительно повышают первоначальную **прочность записи в памяти**, что отражается в более высоком стартовом SS. Иными словами, после 2–3 повторений с интервалом в минуты, вероятность вспомнить на следующий день существенно выше, чем после однократного предъявления. Это снижает начальную нагрузку забывания.

Мы планируем позволить пользователю задавать желаемую **длительность учебной сессии** (например, "сейчас учусь 20 минут"). Тогда система может подбирать количество новых карточек и частоту их внутрисессионных повторов таким образом, чтобы уложиться в указанные ~20 минут. Например, если пользователь выбрал сессию 20 минут, система может прогнозировать, сколько карточек реально успеть за это время (учитывая, что на каждую новую может уйти, скажем, ~2-3 минуты с учетом повторов, а на каждую старую – ~10-20 секунд). Соответственно, будет ограничено число новых слов, вводимых в этой сессии, и интенсивность повторения старых. Если же выбрана длинная сессия (30-40 минут), система может включить больше новых карточек и дать больше времени на их первоначенное закрепление.

**Адаптация к времени сессии:** Дополнительно, когда до конца отведенного времени остается немного, алгоритм может **динамически подстраиваться** – напр. не начинать изучение нового слова, если известно, что не хватит времени на его 2-3 повтора; вместо этого лучше за оставшиеся минуты повторить ранее изученные карточки или завершить сессию. Таким образом, время пользователя используется максимально эффективно.

## Индивидуальная адаптация пользователя

Каждый человек запоминает с разной скоростью. Наша система предусматривает несколько уровней адаптации под особенности конкретного пользователя:

### Учет возраста пользователя

На этапе регистрации или настройки профиля пользователь указывает свою **возрастную категорию**. Это важно, так как возраст влияет на память. Исследования показывают, что с возрастом способность к запоминанию и извлечению информации может снижаться – наблюдается естественный когнитивный спад, затруднения с ассоциативной памятью и т.д.. Хотя интервальное повторение эффективно работает **и у пожилых**, они могут извлекать из него немного меньшую пользу, чем молодые, из-за этих факторов. Чтобы компенсировать возможное ускоренное забывание у более взрослых пользователей, система будет менять некоторые стартовые параметры:

- **Молодые (примерно до 18 лет):** можно использовать стандартные или даже слегка повышенные интервалы, так как у детей и подростков высокая нейропластичность. Однако у очень юных пользователей может быть ниже концентрация внимания, поэтому при необходимости можно уменьшить количество новых карточек в день, но не обязательно интервалы. В целом, базовый EF=2.5 и I(1)=1 день подходят.
    
- **Взрослые (≈18–50 лет):** базовые настройки по умолчанию (как описано выше) – EFstart≈2.5 (250%), первый интервал 1 день, второй ~6 дней и т.д. Эта группа считается **референтной**.
    
- **Старшие (50+ лет):** рекомендуется более консервативный режим. Стартовый EFEF можно слегка снизить, например до **2.3** (230%), чтобы начальные интервалы были короче. Также можно установить меньший _целевой уровень удержания_ при расчете интервалов – например, ориентироваться на 85–90% вероятности вместо 90–95%. Это приведет к более частым повторениям, но повысит реальное удержание знаний для людей с возрастным снижением памяти. Практически это реализуется тем, что после каждого успешного ответа «Хорошо»/«Легко» рост интервала будет немного меньше, чем у молодых. Например, второй интервал вместо 6 дней может быть 5 дней, третий – не 5×EF, а чуть меньше и т.д.
    

Важно отметить, что возраст – лишь приблизительный показатель. У некоторых пожилых людей отличная память, а у некоторых молодых – хуже среднего. Поэтому возрастные настройки выступают как **начальная калибровка**. Далее система подправит параметры по фактическим результатам обучения (см. следующий раздел).

### Калибровка кривой запоминания по данным пользователя

Чтобы точно подстроиться под способности конкретного человека, система будет проводить периодическую **калибровку параметров памяти**. Планируется использовать подход с пакетами по ~50 наблюдений. То есть после того, как система накопила первые 50 ответов пользователя (оценок «Снова», «Трудно», «Хорошо», «Легко»), можно проанализировать его реальный уровень удержания и внести поправки в алгоритм.

**Метрика для калибровки** – фактический процент успеха при повторениях по планируемому расписанию. Например, мы настраиваем интервалы исходя из целевого ~90% уровня запоминания к моменту повторения. Если после 50 карточек окажется, что пользователь **забывает чаще**, чем ожидалось (скажем, успешное воспроизведение лишь в 75% случаев на назначенных повторениях), значит наши интервалы для него слишком длинные или EF завышен. Напротив, если успех близок к 100% и почти нет ошибок, интервалы можно удлинить (пользователь учится легче, чем предполагалось).

**Процесс калибровки:** алгоритм вычисляет **фактор отклонения** – отношение фактической ретенции к целевой. В примере: фактическая 75% / целевая 90% = ~0.83. Можно скорректировать Ease Factors всех карточек пользователя, помножив на этот коэффициент, или изменить глобальный параметр “скорости обучения”. Практически, после каждых 50 ответов мы можем менять не напрямую все прошлые интервалы, а **влияние на будущие расчеты**:

- Если пользователь запоминает хуже ожидаемого (коэффициент < 1), то **снижаем глобальный множитель интервалов**. Например, установить «модификатор интервала» 0.85 (85%) – все рассчитанные интервалы будут дополнительно умножаться на 0.85. Это вынудит систему повторять чаще.
    
- Если пользователь запоминает лучше (коэффициент > 1), можно увеличить модификатор (>1). Но обычно лучше держать высокий запас прочности (90%+) и не стремиться к уменьшению повторений ценой снижения ретенции. Поэтому при коэффициенте >1 система может лишь слегка увеличить EF (например, +0.1 глобально) или оставить как есть, позволяя экономить время без потери качества.
    
Калибровка в _50 наблюдений_ – компромисс между статистической надежностью и скоростью адаптации. 50 ответов дают более-менее стабильную оценку уровня запоминания. Можно выполнять такую корректировку несколько раз: например, после 50, 100, 150 ответов… постепенно приближаясь к оптимальным для данного человека параметрам. В дальнейшем, когда данных станет много, возможен переход к более продвинутой модели (например, алгоритм FSRS с машинным обучением параметров **Difficulty, Stability, Retrievability** под каждого пользователя). Но на первом этапе достаточно линейной подстройки EFEF и/или глобального интервал-модификатора.

**Пример калибровки:**

- Начальные настройки рассчитаны на 90% удержание. После первой недели пользователь просмотрел 50 карточек; из них к моменту повторения 15 оказались забыты (т.е. 35 успешных, 15 “Снова”). Реальный удержанный процент = 70%. Это значительно ниже цели. Система автоматически снижает все текущие EF на ~15% (поскольку 70/90 ≈ 0.78, можно округлить до 0.85 для мягкости). Также она уменьшает минимальный интервал: например, вместо 1 дня может временно показывать особо проблемные карточки через 12 часов перед тем, как снова перейти к суточному циклу. В результате ближайшие повторения станут чаще, и пользователь будет меньше забывать.
    
- При следующей оценке (скажем, через еще 50-100 повторов) видно улучшение: процент успеха поднялся до 88%. Это близко к цели, корректировки можно минимизировать. Возможно, система оставит текущие параметры или чуть скорректирует (еще чуток уменьшит EF глобально, чтобы довести до ~90%).
    
- Если наоборот, сначала пользователь показывал 95–100% успеха (почти не забывал ничего), система могла бы повысить глобальный EF или увеличить целевой порог: например, стремиться к 95% удержания (тем самым допускается реже повторять, экономя время). Но, как правило, избыточный запас – не проблема, и можно просто добавить больше новых карточек в день, раз старые даются легко.
    
Таким образом, за счет калибровки каждому пользователю постепенно подбирается своя **кривая забывания**. По сути, мы подгоняем параметр SS (стабильность роста) из формулы кривой забывания под конкретного человека. Молодой способный ученик получит более пологие кривые (большие интервалы), а пользователь со слабой памятью – более крутые (чаще повторения). Все это происходит автоматически на основе собранных данных о том, как часто и при каких интервалах данный человек забывает.

## Примеры работы системы

Ниже приводятся примеры сценариев, демонстрирующие все описанные нюансы.

**Сценарий 1: Новое слово, успешное запоминание.**  
Пусть пользователь – студент ~20 лет, со стандартными настройками. Он изучает новое иностранное слово “apple” с помощью карточки.

- **Этап изучения:** Слово показывается впервые с переводом и картинкой. Затем сразу проверяется – программа просит перевод. Пользователь отвечает правильно. Он нажимает «Хорошо» (потратил небольшое усилие). Система планирует повтор через **2 минуты** (первый внутренний интервал).
    
- Через 2 минуты карточка появляется снова. На этот раз пользователь отвечает мгновенно, без ошибок. Он выбирает «Легко». По правилу для внутрисессионного режима, ответ «Легко» может сразу выпустить карточку из обучения. Система пропускает оставшийся 10-минутный шаг и отмечает карточку выученной. **Первый долгосрочный интервал** ставится = 1 день. (Если бы он нажал просто «Хорошо», карточка пошла бы на шаг 10 минут, но в данном случае “легко” ускорило процесс).
    
- **Первое повторение (на следующий день):** Вернувшись на следующий день, студент видит эту карточку. Предположим, он вспомнил слово, но не мгновенно – нажимает «Хорошо». Это **первое повторение** после обучения, так что I(1)=1 день был выдержан. Теперь система вычисляет I(2). У карточки текущий EF=2.5. При ответе «Хорошо» мы не изменяем EF. Второй интервал I(2)=1×2.5=2.5 дня. Принято округлять до целого числа – например, до **3 дней** (в большую сторону, чтобы интервал не был меньше прошлого). Карточка запланирована через 3 дня.
    
- **Второе повторение (через ~3 дня):** Карточка приходит снова. Пользователь вспоминает почти автоматически – нажимает «Легко». Это означает, что прошлый интервал был явно коротковат. Система увеличивает EF: было 2.5, добавляем +0.15 → EF=2.65. Также применяется Easy бонус к интервалу: новый интервал I(3)=3дн×2.65×1.3≈10.34 дн. Округляем до **10 дней** (можно вниз чуть, т.к. мы добавили бонус и так). Повтор назначен через 10 дней.
    
- **Третье повторение (через 10 дней):** Карточка показывается, пользователь вспоминает, хотя и с небольшим напряжением (долго не видел). Он выбирает «Хорошо». EF=2.65 остаётся (при «Хорошо» мы решили не менять EF или можем чуть опустить на 0.05; допустим оставили ~2.65). Интервал I(4)=10×2.65≈26.5 дней, округляем до **27 дней** (~4 недели).
    
- **Четвёртое повторение (~27 дней спустя):** Пользователь по-прежнему помнит слово, хотя прошло почти 4 недели. Он нажимает «Хорошо». EF без изменений. I(5)=27×2.65≈71.5 дней, округляем ~**72 дня** (~2.5 месяца).
    
- ...Таким образом, слово “apple” постепенно уходит на всё более далекий повтор. Если в какой-то момент студент отметит «Трудно» или забудет, интервалы скорректируются. В этом сценарии все ответы были своевременными, и за ~3-4 повторения карточка вышла на интервал ~2–3 месяца с вероятностью воспоминания ~90%.
    
**Сценарий 2: Сложное слово, повторные забывания.**  
Рассмотрим другой случай: пользователь учит слово “notwithstand” и постоянно путается.

- При первом предъявлении он не смог воспроизвести перевод – нажимает **«Снова»**. Карточка немедленно (через ~**20 секунд**) повторяется – система может сразу снова спросить или показать правильный ответ и затем спросить спустя 1 минуту. Предположим, через 1 минуту повтор – пользователь вспомнил (только что видел ответ). Он жмёт «Хорошо». Далее по плану – следующий шаг через 10 минут.
    
- Через 10 минут – опять ошибается («Снова»). Карточка возвращается на первый шаг (через 2 минуты). Пользователь раздражается, но через 2 минуты повторяет, на этот раз правильно («Хорошо»), затем через 10 минут снова правильно. Наконец карточка выпускается на 1 день. _Замечание:_ из-за нескольких провалов подряд мы можем снизить её EF даже до выхода в длинные интервалы, чтобы учесть высокую сложность. Скажем, EFnew=2.5−0.2=2.3 (–20% за серию неудач).
    
- На **следующий день** (формально I(1)=1 день карточка показывается, и снова пользователь не помнит… («Снова»). Это уже **повторное забывание после выпуска**. Правило: при провале на стадии повторений карточка возвращается в режим обучения. Интервал обнуляется – ей назначается, например, немедленный показ (или через 5 минут, если сессия длинная). Также EF снова снижается на 0.2, но не меньше 1.3. После этого она снова должна пройти 2м/10м цикл внутри сессии. Допустим, теперь она наконец два раза подряд правильно вспомнилась внутри текущей сессии. Карточка вновь устанавливается как выученная с EF≈2.1 (уже уменьшенным) и интервалом 1 день.
    
- **На следующий день** пользователь вспоминает, но с трудом («Трудно»). Значит, хоть он и повторил вчера, слово все еще шатко. Система: EF=2.1−0.15=1.95 Следующий интервал = 1день×1.2=1.2 дня, округляем до **2 дней** (можно минимум на +1 день от предыдущего). Через 2 дня будет повтор.
    
- Через 2 дня – пользователь отвечает «Хорошо». EF остаётся ~1.95. Интервал = 2×1.95≈3.92≈3.9 дня, округ ~**4 дня**.
    
- Через 4 дня – снова **забыто** («Снова»). Карточка опять идёт на реанимацию: возвращается в обучение (возможно, сразу покажется в той же сессии, если пользователь сейчас занимается). Если сессия уже закончена, то на следующей сессии она начнёт с краткого повторения. EF снижается до max(1.3, 1.95-0.2=1.75) = **1.75**. После успешного ре-обучения (вспомнил через 2м и 10м) снова I(1)=1 день.
    
- Теперь карточка имеет EF=1.75 – довольно низкий. При очередных успехах её интервалы будут расти медленно (множитель 1.75). Допустим, далее пользователь начал улучшаться: на следующий день отметил «Хорошо» (интервал 1×1.75≈**2 дня**), потом через 2 дня «Хорошо» (интервал 2×1.75≈**3.5 дня**, ~4 дня), потом 4 дня спустя «Хорошо» (интервал ~7 дней), затем «Хорошо» (интервал ~12 дней), потом «Хорошо» (21 день) и т.д. Постепенно слово все же закрепится, хотя потребует больше повторений.
    
В этом примере видно, как система обращается с трудным материалом: частые провалы привели к тому, что коэффициент легкости упал к минимуму 1.3–1.75, а интервалы росли медленно (поначалу почти ежедневно). Но даже в таком случае карта не осталась навсегда ежедневной: каждый успешный ответ хоть немного увеличивал интервал (1→2→4→7→12 дней→...). Со временем пользователь начал справляться, и слово все-таки будет выучено – просто с бóльшим числом повторений. Этот подход соответствует желаемому: трудные элементы повторяются чаще, легкие – реже.

**Сценарий 3: Адаптация к пользователю.**  
Предположим, два разных пользователя проходят через 50 повторений и получают разный успех:

- Пользователь A (молодой, много практикуется) из 50 заданных повторений ответил правильно 48, и только 2 раза нажал «Снова». Его фактическая ретенция 96%. Система была настроена на 90%. После анализа она решает слегка **увеличить сложность**: можно либо поднять глобальный множитель интервалов (например, с 1.0 до ~1.05, что даст чуть большие интервалы), либо увеличить поток нового материала (чтобы учебное время расходовать эффективнее, раз старые карточки не требуют столько внимания). В результате A будет продвигаться быстрее. В будущем, если он продолжит с таким же запасом, можно повысить целевую планку до 95% – то есть стремиться к 95% удержания ценой еще более редких повторений. Однако обычно лучше вместо снижения частоты повторений просто давать больше новых карточек, раз память справляется (тут уже решение за методикой обучения – либо ускорять обучение, либо повышать итоговый процент).
    
- Пользователь B (скажем, 60 лет, давно не учил языки) из 50 повторений вспомнил только 35, а 15 раз ошибся (70% успеха). Система реагирует: **снижает Ease Factor** у всех его карточек, например, на 15%. Кроме того, возможно, уменьшает цель удержания до ~85% временно, чтобы не перегружать. Следующие несколько дней его карточки будут повторяться чаще. Допустим, через еще 50 повторений успех вырос до 80%. Прогресс есть, но цель 90% не достигнута – еще подстройка: например, глобальный множитель 0.85 увеличивается до 0.9 (т.е. интервалы все равно укорочены относительно стандартных, но чуть меньше, чем первоначально). Спустя некоторое время B стабильно удерживает ~87–90%. Система постепенно доведет настройки до оптимальных: возможно, у B так и останется, что EFср.​ ниже среднего (например, средний итоговый EF по карточкам 2.0 против 2.5 у A) – что соответствует более быстрому забыванию. Но теперь это учтено в персональных интервалах, и пользователь B будет учить эффективно, просто с более частыми повторениями.
    
**Сценарий 4: Учебная сессия 20 минут.**  
Пользователь открывает приложение и выбирает «Учиться 20 минут». Система знает, что в среднем за минуту можно провести ~2-3 повторения (с учетом времени на подумать и на интерфейс). Допустим, 20 минут – это порядка 40 повторений. Из них часть уйдет на новые слова (которые требуют больше времени за счет внутрисессионных повторов), часть на запланированные ревью.

- Алгоритм смотрит: на сегодня по расписанию есть 30 карточек на повторение. За 20 минут 30 можно успеть (30 ревью ≈ 10-15 минут). Остается время на новые слова. Система решает добавить, например, 5 новых слов (их первый показ + обучение как раз займет ~5-10 минут, учитывая, что каждый новый потребует 2-3 показа).
    
- В процессе сессии приложение сначала предлагает микс: несколько старых повторений, затем новое слово, затем снова старые, и т.д., чтобы чередовать нагрузку.
    
- Если пользователь замедляется (скажем, долго думает над ответами), и становится ясно, что он не успеет пройти все запланированное, система может **динамически уменьшить** число новых слов (например, прекратить ввод новых после 3 вместо 5) или перенести часть не критичных повторений на потом (например, какие-то карточки могут чуть переждать до завтра без большой потери, особенно если их вероятность воспоминания сейчас и так высокая – в некоторых реализациях это называется приоритетным порядком показа). Но на первом этапе можно просто ограничиться тем, что если время истекает, сессия прерывается и оставшиеся карточки остаются на следующий раз.
    
- По окончании 20 минут пользователь увидит сообщение «Сессия завершена: вы повторили 30 старых слов и выучили 5 новых». Несделанные повторы (если остались) переходят на следующий день или на следующую сессию.
    
Если бы пользователь выбрал **40 минут**, система могла бы распределить больше новых слов (скажем, 10-15) и охватить все запланированные повторения. Таким образом, указание времени сессии служит ограничителем объема работы, а алгоритм старается максимально эффективно заполнить отведенное время, отдавая приоритет, конечно, _срочным повторениям_ (чтобы не забыть то, что уже должно было быть повторено) и _краткосрочному закреплению_ новых элементов.

## Заключение

Предложенная система интервального повторения сочетает в себе проверенные временем подходы (алгоритм SM-2/Anki с 4 уровнями оценки и Ease Factor) и дополнительные механизмы адаптации:

- экспоненциальный рост интервалов на основе _кривой забывания_ Эббингауза;
    
- **внутрисессионное обучение** в пределах минут для быстрого закрепления нового материала;
    
- **дифференцированный подход к сложным карточкам** через понижение Ease Factor и сброс интервалов при забывании;
    
- учет особенностей аудитории (возраста) в начальных параметрах;
    
- **калибровка по статистике** успехов, позволяющая системе учиться на опыте пользователя и приближать фактическую эффективность к заданным целям;
    
- возможность **ограничивать сессию по времени**, чтобы интегрировать обучение в расписание пользователя наиболее удобным образом.
    
Все формулы и коэффициенты, приведенные выше, основаны на литературных данных и практических рекомендациях. Например, базовые интервалы 1 день, 6 дней, рост ~2.5× согласуются с классическим алгоритмом SM-2, а градации кнопок и изменения Ease Factor – с открытой реализацией Anki. Экспоненциальная модель забывания подтверждается экспериментальными кривыми (данные приложения MaiMemo и алгоритма FSRS), а ограничения вроде минимального EF=130% введены на основе исследований SuperMemo.
При реализации системы важно сохранить гибкость: параметры (как то 1.2 для «Трудно» или +15% к EF за «Легко») могут тонко настраиваться и даже изучаться автоматически. Тем не менее, описанные значения дают разумное начало, проверенное на тысячах пользователей электронных флеш-карт.
С этой всеобъемлющей схемой можно переходить к разработке прототипа и программной реализации алгоритма. Программистам следует уделить внимание точной обработке событий (сброс шагов при провале, переход карточки между очередями обучения и повторения, округление интервалов до дней, контроль границ EF и интервалов и т.д.) – все эти нюансы перечислены выше и снабжены пояснениями. Такая система поможет пользователям эффективно учить слова, максимально используя преимущества интервала́х повторения и адаптируясь к их индивидуальному поведению и способностям.
